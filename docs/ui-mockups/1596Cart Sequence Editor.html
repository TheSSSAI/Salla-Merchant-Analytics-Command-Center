<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart Sequence Editor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* -------------------------------------------------------------------------- */
    /* 1. DESIGN TOKENS                                                           */
    /* -------------------------------------------------------------------------- */
    :root {
      /* Palette: Indigo Primary */
      --color-primary-50: #eef2ff;
      --color-primary-100: #e0e7ff;
      --color-primary-500: #6366f1;
      --color-primary-600: #4f46e5;
      --color-primary-700: #4338ca;

      /* Palette: Neutrals */
      --color-white: #ffffff;
      --color-gray-50: #f8fafc;
      --color-gray-100: #f1f5f9;
      --color-gray-200: #e2e8f0;
      --color-gray-300: #cbd5e1;
      --color-gray-400: #94a3b8;
      --color-gray-500: #64748b;
      --color-gray-600: #475569;
      --color-gray-700: #334155;
      --color-gray-900: #0f172a;

      /* Semantic */
      --color-error: #ef4444;
      --color-success: #10b981;

      /* Dimensions & Spacing */
      --spacing-2: 0.5rem;   /* 8px */
      --spacing-3: 0.75rem;  /* 12px */
      --spacing-4: 1rem;     /* 16px */
      --spacing-6: 1.5rem;   /* 24px */
      --spacing-8: 2rem;     /* 32px */
      
      --radius-md: 6px;
      --radius-lg: 8px;
      
      /* Typography */
      --font-family: 'Inter', system-ui, sans-serif;
      --text-xs: 0.75rem;
      --text-sm: 0.875rem;
      --text-base: 1rem;
      --text-lg: 1.125rem;
      --text-xl: 1.25rem;
      
      /* Effects */
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      --focus-ring: 0 0 0 2px var(--color-white), 0 0 0 4px var(--color-primary-600);
    }

    /* -------------------------------------------------------------------------- */
    /* 2. BASE STYLES                                                             */
    /* -------------------------------------------------------------------------- */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: var(--font-family);
      background-color: var(--color-gray-50);
      color: var(--color-gray-900);
      line-height: 1.5;
      padding: var(--spacing-8);
    }

    /* -------------------------------------------------------------------------- */
    /* 3. ATOMS & UTILITIES                                                       */
    /* -------------------------------------------------------------------------- */
    .icon {
      width: 20px;
      height: 20px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    
    .icon--sm { width: 16px; height: 16px; }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-2);
      padding: var(--spacing-2) var(--spacing-4);
      border-radius: var(--radius-md);
      font-size: var(--text-sm);
      font-weight: 500;
      cursor: pointer;
      border: 1px solid transparent;
      transition: all 0.2s;
    }

    .btn:focus-visible { outline: none; box-shadow: var(--focus-ring); }

    .btn--primary {
      background-color: var(--color-primary-600);
      color: var(--color-white);
    }
    .btn--primary:hover { background-color: var(--color-primary-700); }

    .btn--secondary {
      background-color: var(--color-white);
      border-color: var(--color-gray-300);
      color: var(--color-gray-700);
    }
    .btn--secondary:hover { background-color: var(--color-gray-50); }

    .btn--ghost {
      background-color: transparent;
      color: var(--color-gray-500);
    }
    .btn--ghost:hover {
      background-color: var(--color-gray-100);
      color: var(--color-gray-900);
    }
    
    .btn--icon { padding: var(--spacing-2); }

    .input {
      display: block;
      width: 100%;
      padding: var(--spacing-2) var(--spacing-3);
      border-radius: var(--radius-md);
      border: 1px solid var(--color-gray-300);
      background-color: var(--color-white);
      color: var(--color-gray-900);
      font-size: var(--text-sm);
      transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }
    .input:focus {
      border-color: var(--color-primary-500);
      outline: 0;
      box-shadow: 0 0 0 3px var(--color-primary-100);
    }

    .label {
      display: block;
      font-size: var(--text-sm);
      font-weight: 500;
      color: var(--color-gray-700);
      margin-bottom: 4px;
    }

    /* -------------------------------------------------------------------------- */
    /* 4. MOLECULES (Dependencies)                                                */
    /* -------------------------------------------------------------------------- */
    
    /* RTE Toolbar Button */
    .rte-toolbar-btn {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: transparent;
      border-radius: var(--radius-md);
      color: var(--color-gray-600);
      cursor: pointer;
    }
    .rte-toolbar-btn:hover { background-color: var(--color-gray-100); color: var(--color-gray-900); }
    .rte-toolbar-btn--active { background-color: var(--color-gray-200); color: var(--color-gray-900); }

    /* -------------------------------------------------------------------------- */
    /* 5. ORGANISM: CART SEQUENCE EDITOR                                          */
    /* -------------------------------------------------------------------------- */
    
    .seq-editor {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: var(--spacing-6);
    }

    /* Editor Header */
    .seq-editor__header {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-4);
      padding-bottom: var(--spacing-4);
      border-bottom: 1px solid var(--color-gray-200);
    }
    
    @media (min-width: 768px) {
      .seq-editor__header {
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
      }
    }

    .seq-editor__title h2 {
      font-size: var(--text-xl);
      font-weight: 600;
      color: var(--color-gray-900);
    }
    .seq-editor__title p {
      color: var(--color-gray-500);
      font-size: var(--text-sm);
    }

    .seq-editor__actions {
      display: flex;
      gap: var(--spacing-3);
    }

    /* Timeline Container */
    .seq-timeline {
      position: relative;
      display: flex;
      flex-direction: column;
      gap: var(--spacing-6);
      padding-left: var(--spacing-4); /* Space for mobile */
    }

    @media (min-width: 768px) {
      .seq-timeline {
        padding-left: 48px; /* Space for line and nodes */
      }
      
      /* Vertical Line */
      .seq-timeline::before {
        content: '';
        position: absolute;
        top: 24px;
        bottom: 24px;
        left: 20px;
        width: 2px;
        background-color: var(--color-gray-200);
        z-index: 0;
      }
    }

    /* Step Item Wrapper */
    .seq-step {
      position: relative;
      z-index: 1;
    }

    /* Timeline Node (Circle) */
    .seq-step__node {
      display: none;
    }

    @media (min-width: 768px) {
      .seq-step__node {
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        left: -48px; /* Alignment with padding */
        top: 24px;   /* Align with card header center */
        width: 42px;
        height: 42px;
        background-color: var(--color-white);
        border: 2px solid var(--color-gray-200);
        border-radius: 50%;
        color: var(--color-gray-500);
        font-size: var(--text-sm);
        font-weight: 600;
        z-index: 1;
      }
      
      .seq-step__node--active {
        border-color: var(--color-primary-600);
        color: var(--color-primary-600);
        background-color: var(--color-primary-50);
      }
    }

    /* Step Card */
    .step-card {
      background: var(--color-white);
      border: 1px solid var(--color-gray-200);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      overflow: hidden;
      transition: box-shadow 0.2s ease, border-color 0.2s ease;
    }

    .step-card:focus-within {
      border-color: var(--color-primary-500);
      box-shadow: var(--shadow-md);
    }

    /* Step Card Header: Delay Config */
    .step-card__header {
      background-color: var(--color-gray-50);
      padding: var(--spacing-4);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-3);
      border-bottom: 1px solid var(--color-gray-200);
    }

    @media (min-width: 640px) {
      .step-card__header {
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
      }
    }

    .step-card__meta {
      display: flex;
      align-items: center;
      gap: var(--spacing-3);
    }

    .step-card__drag {
      cursor: grab;
      color: var(--color-gray-400);
      display: none;
    }
    
    @media (min-width: 1024px) {
      .step-card__drag { display: block; }
    }

    .step-delay-group {
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
      background: var(--color-white);
      padding: 4px;
      border: 1px solid var(--color-gray-300);
      border-radius: var(--radius-md);
    }
    
    .step-delay-group:focus-within {
      border-color: var(--color-primary-600);
      box-shadow: 0 0 0 1px var(--color-primary-600);
    }

    .step-delay-group__label {
      padding-left: var(--spacing-2);
      font-size: var(--text-xs);
      font-weight: 600;
      color: var(--color-gray-500);
      text-transform: uppercase;
    }

    .step-delay-group__input {
      width: 60px;
      border: none;
      text-align: center;
      font-weight: 600;
      color: var(--color-gray-900);
      padding: 4px;
    }
    .step-delay-group__input:focus { outline: none; }

    .step-delay-group__select {
      border: none;
      background: transparent;
      font-size: var(--text-sm);
      color: var(--color-gray-700);
      padding-right: var(--spacing-2);
      cursor: pointer;
    }
    .step-delay-group__select:focus { outline: none; }

    .step-card__tools {
      display: flex;
      gap: var(--spacing-2);
    }

    /* Step Card Body: Content & RTE */
    .step-card__body {
      padding: var(--spacing-4);
    }

    .step-form-grid {
      display: grid;
      gap: var(--spacing-4);
    }

    /* Rich Text Editor Mockup */
    .rte-wrapper {
      border: 1px solid var(--color-gray-300);
      border-radius: var(--radius-md);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    .rte-wrapper:focus-within {
      border-color: var(--color-primary-600);
      box-shadow: 0 0 0 1px var(--color-primary-600);
    }

    .rte-toolbar {
      background-color: var(--color-gray-50);
      border-bottom: 1px solid var(--color-gray-200);
      padding: var(--spacing-2);
      display: flex;
      gap: var(--spacing-1);
      flex-wrap: wrap;
    }

    .rte-divider {
      width: 1px;
      background-color: var(--color-gray-300);
      margin: 0 var(--spacing-1);
    }

    .rte-content {
      min-height: 120px;
      padding: var(--spacing-3);
      font-size: var(--text-sm);
      color: var(--color-gray-700);
      outline: none;
    }
    
    .rte-content[contenteditable]:empty::before {
      content: attr(placeholder);
      color: var(--color-gray-400);
    }

    /* Add Step Button */
    .seq-add-step {
      display: flex;
      justify-content: center;
      position: relative;
      z-index: 1;
    }
    
    @media (min-width: 768px) {
      .seq-add-step {
        justify-content: flex-start;
        padding-left: 0; /* Align with card start */
      }
    }

    .btn-add-step {
      border-style: dashed;
      border-color: var(--color-gray-300);
      color: var(--color-primary-600);
      background: var(--color-white);
      width: 100%;
      padding: var(--spacing-3);
    }
    
    .btn-add-step:hover {
      border-color: var(--color-primary-500);
      background-color: var(--color-primary-50);
    }

    /* -------------------------------------------------------------------------- */
    /* 6. VARIANTS & UTILITIES                                                    */
    /* -------------------------------------------------------------------------- */
    
    .u-hidden { display: none; }
    .u-sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }

    /* Expanded vs Collapsed */
    .step-card--collapsed .step-card__body { display: none; }
    .step-card--collapsed .step-card__header { border-bottom: none; }
    
    .step-summary {
      display: flex;
      flex-direction: column;
      font-size: var(--text-sm);
    }
    .step-summary strong { color: var(--color-gray-900); }
    .step-summary span { color: var(--color-gray-500); }

  </style>
</head>
<body>

  <!-- Component Wrapper -->
  <div class="seq-editor">
    
    <!-- 1. Header -->
    <header class="seq-editor__header">
      <div class="seq-editor__title">
        <h2>Abandoned Cart Sequence</h2>
        <p>Targeting customers with cart value > $100</p>
      </div>
      <div class="seq-editor__actions">
        <span style="display:flex; align-items:center; gap:8px; font-size:0.875rem; color:var(--color-gray-600); margin-right:8px;">
          <span style="width:8px; height:8px; background:var(--color-success); border-radius:50%;"></span>
          Active
        </span>
        <button class="btn btn--secondary">Cancel</button>
        <button class="btn btn--primary">Save Changes</button>
      </div>
    </header>

    <!-- 2. Timeline Canvas -->
    <div class="seq-timeline" role="list" aria-label="Sequence Steps">
      
      <!-- STEP 1: EXPANDED (Active Edit) -->
      <div class="seq-step" role="listitem">
        <div class="seq-step__node seq-step__node--active">1</div>
        <div class="step-card">
          <!-- Card Header / Configuration -->
          <div class="step-card__header">
            <div class="step-card__meta">
              <svg class="icon step-card__drag" viewBox="0 0 24 24"><path d="M9 5H21M9 12H21M9 19H21M5 5H5.01M5 12H5.01M5 19H5.01" stroke-width="2"></path></svg>
              
              <div class="step-delay-group">
                <span class="step-delay-group__label">Wait</span>
                <input type="number" class="step-delay-group__input" value="1" min="1" aria-label="Delay amount">
                <select class="step-delay-group__select" aria-label="Delay unit">
                  <option value="hours" selected>Hour(s)</option>
                  <option value="days">Day(s)</option>
                </select>
                <span class="step-delay-group__label" style="padding-right:8px; padding-left:0; font-weight:400; color:var(--color-gray-500)">after abandonment</span>
              </div>
            </div>
            
            <div class="step-card__tools">
              <button class="btn btn--ghost btn--icon" aria-label="Collapse step" title="Collapse">
                <svg class="icon" viewBox="0 0 24 24"><path d="M18 15l-6-6-6 6"/></svg>
              </button>
              <button class="btn btn--ghost btn--icon" aria-label="Delete step" title="Delete" style="color:var(--color-error)">
                <svg class="icon" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
              </button>
            </div>
          </div>

          <!-- Card Body / RTE -->
          <div class="step-card__body">
            <div class="step-form-grid">
              <div>
                <label class="label" for="subject-1">Email Subject</label>
                <input type="text" id="subject-1" class="input" value="You left something behind! ðŸ‘€" placeholder="Enter email subject line...">
              </div>
              
              <div>
                <label class="label" id="content-label-1">Email Content</label>
                <div class="rte-wrapper" aria-labelledby="content-label-1">
                  <div class="rte-toolbar" role="toolbar" aria-label="Formatting options">
                    <button class="rte-toolbar-btn rte-toolbar-btn--active" title="Bold" aria-label="Bold"><svg class="icon icon--sm" viewBox="0 0 24 24"><path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path><path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path></svg></button>
                    <button class="rte-toolbar-btn" title="Italic" aria-label="Italic"><svg class="icon icon--sm" viewBox="0 0 24 24"><line x1="19" y1="4" x2="10" y2="4"></line><line x1="14" y1="20" x2="5" y2="20"></line><line x1="15" y1="4" x2="9" y2="20"></line></svg></button>
                    <div class="rte-divider"></div>
                    <button class="rte-toolbar-btn" title="Link" aria-label="Insert Link"><svg class="icon icon--sm" viewBox="0 0 24 24"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button>
                    <div class="rte-divider"></div>
                    <button class="btn btn--xs btn--secondary" style="font-size:11px; padding:2px 8px; margin-left:auto;">{ } Variable</button>
                  </div>
                  <div class="rte-content" contenteditable="true" role="textbox" aria-multiline="true">
                    Hi {{customer.first_name}},<br><br>
                    We noticed you left some great items in your cart. We saved them for you!<br><br>
                    <a href="#" style="color:var(--color-primary-600)">Return to Checkout</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- STEP 2: COLLAPSED (Summary View) -->
      <div class="seq-step" role="listitem">
        <div class="seq-step__node">2</div>
        <div class="step-card step-card--collapsed">
          <div class="step-card__header">
            <div class="step-card__meta">
              <svg class="icon step-card__drag" viewBox="0 0 24 24"><path d="M9 5H21M9 12H21M9 19H21M5 5H5.01M5 12H5.01M5 19H5.01" stroke-width="2"></path></svg>
              
              <div class="step-delay-group" style="background:transparent; border:none; padding:0;">
                <span style="font-weight:600; color:var(--color-gray-900); font-size:var(--text-sm);">Wait 24 Hours</span>
                <span style="font-size:var(--text-xs); color:var(--color-gray-500);">after previous step</span>
              </div>
              
              <!-- Summary of content for collapsed state -->
              <div class="step-summary" style="padding-left:16px; border-left:1px solid var(--color-gray-300); margin-left:8px;">
                <strong>Subject: Still thinking about it?</strong>
                <span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px;">Don't let your favorites sell out...</span>
              </div>
            </div>
            
            <div class="step-card__tools">
              <button class="btn btn--ghost btn--icon" aria-label="Expand step" title="Edit">
                <svg class="icon" viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
              </button>
              <button class="btn btn--ghost btn--icon" aria-label="Delete step" title="Delete">
                <svg class="icon" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
              </button>
            </div>
          </div>
          <!-- Body hidden via CSS class -->
          <div class="step-card__body"></div>
        </div>
      </div>

      <!-- Add Step Action -->
      <div class="seq-add-step">
        <button class="btn btn-add-step">
          <svg class="icon" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
          Add Step to Sequence
        </button>
      </div>

    </div>
  </div>

  <div style="margin-top: 60px; border-top: 1px solid #e2e8f0; padding-top: 40px; max-width: 900px; margin-left: auto; margin-right: auto;">
    <h2 style="font-size: 1.5rem; margin-bottom: 24px; color: var(--color-gray-900);">Component Variations</h2>
    
    <!-- VARIANT 1 -->
    <div style="margin-bottom: 40px;">
      <h3 style="font-size: 1.125rem; font-weight: 600; color: var(--color-primary-600); margin-bottom: 8px;">Variant: View Only (Read Mode)</h3>
      <p style="color: var(--color-gray-600); margin-bottom: 16px; font-size: 0.875rem;">Simplified view when the user does not have edit permissions or the campaign is running and locked.</p>
      
      <div class="step-card">
        <div class="step-card__header">
          <div class="step-card__meta">
            <span style="width: 32px; height: 32px; background: var(--color-primary-100); color: var(--color-primary-700); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px;">1</span>
            <div>
              <div style="font-weight: 600; font-size: 0.875rem;">Wait 1 Hour</div>
              <div style="font-size: 0.75rem; color: var(--color-gray-500);">after abandonment</div>
            </div>
          </div>
          <div style="font-size: 0.875rem; color: var(--color-gray-600);">
            <strong>Email:</strong> First Reminder
          </div>
        </div>
      </div>
    </div>

    <!-- VARIANT 2 -->
    <div>
      <h3 style="font-size: 1.125rem; font-weight: 600; color: var(--color-primary-600); margin-bottom: 8px;">Variant: Saving State</h3>
      <p style="color: var(--color-gray-600); margin-bottom: 16px; font-size: 0.875rem;">Button state feedback during asynchronous save operations.</p>
      
      <div style="display: flex; gap: 16px;">
        <button class="btn btn--primary" disabled style="opacity: 0.8; cursor: not-allowed;">
          <svg class="icon icon--sm" viewBox="0 0 24 24" style="animation: spin 1s linear infinite"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83" stroke="currentColor" stroke-width="3"></path></svg>
          Saving...
        </button>
      </div>
      <style>@keyframes spin { 100% { transform: rotate(360deg); } }</style>
    </div>

  </div>

</body>
</html>