"story_id","epic","title","user_role","description","business_value","priority","story_points","dependencies","acceptance_criteria","technical_tasks","definition_of_done"
"US-004","Core Infrastructure & Authentication","Secure Merchant Authentication via JWT","Merchant User","As a Merchant User, I want to securely log in and maintain my session using an encrypted token system so that I can access my private dashboard without repeated logins while ensuring my data remains secure.","Establishes the fundamental security perimeter for the application, protecting sensitive merchant data and enabling role-based access control.","Must Have","3","[""WI-INFRA-002""]","[{""scenario"":""Successful Login"",""given"":""I am on the login page with valid credentials"",""when"":""I submit the login form"",""then"":""I receive a short-lived access token and a secure HttpOnly refresh token, and I am redirected to the dashboard.""},{""scenario"":""Session Persistence"",""given"":""I have an active session and my access token expires"",""when"":""I navigate to a protected route"",""then"":""My session is automatically refreshed using the refresh token without requiring re-login.""},{""scenario"":""Secure Logout"",""given"":""I am logged in"",""when"":""I click logout"",""then"":""My local cookies are cleared and the refresh token is invalidated in the database.""}]","[""WI-AUTH-001: Implement JWT Authentication Service"",""WI-INFRA-002: Configure Prisma with User/Session tables""]","[""Login/Logout/Refresh API endpoints functional"",""Tokens are RS256 signed"",""Unit tests cover token rotation logic"",""HttpOnly cookies configured for production""]"
"US-009","Core Infrastructure & Authentication","Connect Salla Store via OAuth 2.0","Store Owner","As a Store Owner, I want to connect my Salla store using the official authorization flow so that the platform can securely access and analyze my sales data.","Critical integration point that enables the entire value proposition of the platform by authorizing data access from the source system.","Must Have","5","[""US-004""]","[{""scenario"":""Successful Authorization"",""given"":""I am a logged-in user on the 'Connect Store' page"",""when"":""I click 'Connect Salla' and approve permissions on the Salla portal"",""then"":""I am redirected back to the app, my access tokens are securely encrypted and stored, and I see a success message.""},{""scenario"":""CSRF Protection"",""given"":""I am initiating the OAuth flow"",""when"":""The state parameter returned from Salla does not match the initial request"",""then"":""The connection attempt is rejected with a security error.""}]","[""WI-AUTH-002: Implement Salla OAuth 2.0 Integration Flow"",""WI-DATA-002: Implement Salla Webhook Handler (Foundation)""]","[""OAuth flow completes successfully end-to-end"",""Tokens are AES-256 encrypted at rest"",""State parameter validation implemented"",""Error callbacks handled gracefully""]"
"US-011","Data Ingestion & Pipeline","Import Historical Store Data","Store Owner","As a Store Owner, I want to import my store's historical data (orders, customers, products) so that I can immediately view analytics and trends from the past 12 or 24 months.","Provides immediate analytical value upon onboarding, allowing users to see trends and forecasts without waiting for new data to accumulate.","Must Have","5","[""US-009""]","[{""scenario"":""Initiate Sync"",""given"":""I have just connected my Salla store"",""when"":""I select 'Import 12 months history'"",""then"":""A background job is queued, and I see a progress indicator.""},{""scenario"":""Sync Completion"",""given"":""The background import job is running"",""when"":""The job completes processing all pages from the Salla API"",""then"":""My dashboard reflects the historical data and the sync status is marked as complete.""}]","[""WI-DATA-001: Implement Historical Data Import Background Job"",""WI-OLAP-002: Implement Postgres to ClickHouse Data Pipeline""]","[""Job handles API rate limits without failing"",""Data is correctly populated in PostgreSQL and ClickHouse"",""Progress is trackable via API"",""Idempotency ensured for re-runs""]"
"US-022","Deep Analytics & Reporting","View Real-Time KPI Dashboard","Business Analyst","As a Business Analyst, I want to view a real-time dashboard of key performance indicators (Sales, Orders, AOV) so that I can monitor store performance and make quick decisions.","Delivers the primary daily usage value of the platform, offering immediate insights into business health with low latency.","Must Have","8","[""US-011"",""WI-OLAP-001""]","[{""scenario"":""Dashboard Loading"",""given"":""I have imported data"",""when"":""I load the dashboard"",""then"":""I see KPI cards for Sales, Orders, AOV, and Conversion populated with data in under 2.5 seconds.""},{""scenario"":""Real-time Updates"",""given"":""A new order is placed in Salla"",""when"":""I refresh the dashboard after 5 minutes"",""then"":""The order count and sales total reflect the new transaction.""}]","[""WI-REP-001: Implement Analytics API Service"",""WI-REP-002: Develop Main Dashboard with KPI Cards"",""WI-OLAP-001: Design & Deploy ClickHouse Schema""]","[""p95 API latency < 200ms"",""Data accuracy verified against source"",""Responsive UI on mobile/desktop"",""Skeleton loading states implemented""]"
"US-032","Deep Analytics & Reporting","Sales Forecasting with Confidence Intervals","Store Owner","As a Store Owner, I want to see a 30-day sales forecast with confidence intervals so that I can plan inventory and marketing budgets effectively.","Provides predictive intelligence that moves the platform beyond simple reporting to strategic planning tool.","Should Have","8","[""US-011""]","[{""scenario"":""View Forecast"",""given"":""I have at least 3 months of historical data"",""when"":""I navigate to the Sales Report"",""then"":""I see a chart projecting sales for the next 30 days with a shaded region indicating 95% confidence.""},{""scenario"":""Insufficient Data"",""given"":""I have less than 3 months of data"",""when"":""I view the forecast section"",""then"":""I see a message explaining that more history is needed to generate accurate predictions.""}]","[""WI-REP-004: Implement Sales Forecasting with ETS Algorithm"",""WI-REP-003: Implement Sales Trend & Product Performance Reports""]","[""ETS algorithm implemented accurately"",""Forecast job runs nightly"",""UI clearly distinguishes historical vs. forecasted data"",""Unit tests for math logic""]"
"US-040","Cart Recovery Module","Automated Abandoned Cart Detection","Marketer","As a Marketer, I want the system to automatically identify carts that have been abandoned for more than 1 hour so that I can trigger recovery workflows to reclaim lost revenue.","Directly impacts the bottom line by identifying lost revenue opportunities that can be recovered.","Must Have","5","[""US-009""]","[{""scenario"":""Detect Abandonment"",""given"":""A customer added items to a cart 61 minutes ago and has not checked out"",""when"":""The abandonment check job runs"",""then"":""The cart status is updated to 'Abandoned' and it appears in the recovery queue.""},{""scenario"":""Avoid False Positives"",""given"":""A customer completed checkout"",""when"":""The abandonment check job runs"",""then"":""The cart is NOT flagged as abandoned.""}]","[""WI-REC-001: Implement Abandoned Cart Detection Job"",""WI-DATA-002: Implement Salla Webhook Handler""]","[""Cron job configured correctly"",""State transition logic tested"",""No false positives in detection"",""Performance validated for high cart volumes""]"
"US-043","Cart Recovery Module","Email Template Customization","Marketer","As a Marketer, I want to create and edit rich-text email templates with dynamic variables so that I can send personalized recovery messages that match my brand voice.","Enhances the effectiveness of recovery campaigns through personalization and branding, increasing conversion rates.","Should Have","5","[""WI-REC-001""]","[{""scenario"":""Create Template"",""given"":""I am in the template editor"",""when"":""I draft an email using the rich text editor and insert {{customer_name}}"",""then"":""I can save the template and preview it with dummy data replacing the variable.""},{""scenario"":""HTML Sanitization"",""given"":""I attempt to paste malicious script tags into the editor"",""when"":""I save the template"",""then"":""The system sanitizes the input and removes the scripts before storage.""}]","[""WI-REC-002: Implement Email Template Editor & Management""]","[""Rich text editor integrated (TipTap/Quill)"",""Variable substitution logic working"",""XSS protection verified"",""Preview functionality operational""]"
"US-035","AI Assistant (RAG)","Natural Language Business Queries","Store Owner","As a Store Owner, I want to ask questions about my business data in plain English/Arabic so that I can get answers without needing to know how to build complex reports.","Democratizes data access for non-technical users and serves as a key market differentiator for the platform.","Could Have","13","[""US-022"",""WI-AI-001""]","[{""scenario"":""Answer Data Question"",""given"":""I am in the AI chat interface"",""when"":""I ask 'What were my top 3 products last week?'"",""then"":""The system converts this to a SQL query, executes it securely, and returns the correct list of products in the chat.""},{""scenario"":""Tenant Isolation"",""given"":""I am logged in as Merchant A"",""when"":""I ask a question that requires a database query"",""then"":""The generated SQL strictly limits results to Merchant A's ID.""}]","[""WI-AI-001: Setup pgvector & Embedding Pipeline"",""WI-AI-002: Implement RAG Query Service"",""WI-AI-003: Develop AI Chat Interface""]","[""RAG pipeline operational"",""SQL generation validated for read-only safety"",""Tenant isolation verified in query construction"",""UI handles loading and error states""]"