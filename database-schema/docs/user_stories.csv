"story_id","epic","title","user_role","description","business_value","priority","story_points","dependencies","acceptance_criteria","technical_tasks","definition_of_done"
"US-001","Authentication & User Management","Merchant Account Registration with Secure Hashing","New Merchant","As a New Merchant, I want to create an account using my email and a secure password so that I can establish a secure identity to access the platform's features.","Establishes the entry point for user acquisition and ensures security compliance via industry-standard password hashing.","Must Have","3","[]","[{""scenario"":""Successful Registration"",""given"":""I am on the registration page with a valid email and strong password"",""when"":""I submit the registration form"",""then"":""A user record and merchant organization are created in the database, and I am redirected to the onboarding flow.""},{""scenario"":""Duplicate Email Handling"",""given"":""An account with my email already exists"",""when"":""I attempt to register with the same email"",""then"":""I receive a clear error message indicating the account exists without revealing sensitive details.""},{""scenario"":""Input Validation"",""given"":""I enter an invalid email format or weak password"",""when"":""I attempt to submit"",""then"":""The system blocks submission and displays specific validation errors (RFC 5322 compliance, complexity rules).""}]","[""WI-AUTH-001: Implement User Registration & Password Hashing""]","[""Argon2/Bcrypt hashing implemented"",""Zod validation schema active"",""Prisma transaction ensures User+Merchant creation atomicity"",""Unit tests for password hashing pass""]"
"US-009","Onboarding & Data Integration","Connect Salla Store via OAuth 2.0","Store Owner","As a Store Owner, I want to securely connect my Salla store using OAuth authorization so that the platform can access my store's data for analysis.","Critical integration point that enables all downstream value; without this, the platform has no data to analyze.","Critical","5","[""US-001""]","[{""scenario"":""Successful OAuth Handshake"",""given"":""I am logged in and viewing the 'Connect Store' page"",""when"":""I click 'Connect Salla' and approve permissions on the Salla consent screen"",""then"":""I am redirected back to the platform, and my access/refresh tokens are securely stored in the database.""},{""scenario"":""Token Encryption"",""given"":""The system receives tokens from Salla"",""when"":""The tokens are persisted to the database"",""then"":""They must be encrypted using AES-256 and not stored in plain text.""},{""scenario"":""CSRF Protection"",""given"":""I initiate the OAuth flow"",""when"":""The callback is received"",""then"":""The system validates the 'state' parameter matches the session state to prevent CSRF attacks.""}]","[""WI-SALLA-001: Implement Salla OAuth 2.0 Flow""]","[""OAuth callback route handles code exchange"",""Encryption utility implemented and verified"",""Refresh token logic is stubbed out"",""Env variables for Salla Client ID/Secret configured""]"
"US-012","Onboarding & Data Integration","Historical Data Synchronization & Progress Tracking","Store Owner","As a Store Owner, I want to view the real-time progress of my historical data import so that I know when my analytics are ready to be viewed.","Provides transparency during long-running processes, improving user experience and reducing support inquiries about missing data.","Must Have","8","[""US-009""]","[{""scenario"":""Sync Job Initiation"",""given"":""I have just connected my Salla store"",""when"":""The connection is confirmed"",""then"":""A background job is triggered via QStash to fetch historical Orders, Customers, and Products.""},{""scenario"":""Rate Limit Handling"",""given"":""The Salla API returns a 429 Rate Limit error"",""when"":""The background worker encounters this error"",""then"":""The worker pauses and retries with exponential backoff without failing the job.""},{""scenario"":""Progress Visualization"",""given"":""The sync job is running"",""when"":""I view the dashboard"",""then"":""I see a progress bar reflecting the percentage of data processed via client-side polling.""}]","[""WI-SYNC-001: Historical Data Sync Worker"",""WI-SYNC-002: Sync Progress & Status UI""]","[""Background worker correctly pages through Salla API"",""Prisma createMany used for bulk insertion"",""Status endpoint returns accurate % complete"",""Resiliency tests pass for API interruptions""]"
"US-022","Analytics Dashboards & Reporting","Main Dashboard with Sales KPIs and Trends","Data Analyst","As a Data Analyst, I want to view a dashboard with aggregated KPIs (AOV, Total Sales) and trend charts so that I can assess business performance at a glance.","Delivers the core promise of the SaaS application: visualizing business intelligence to drive decision-making.","High","8","[""US-012""]","[{""scenario"":""Dashboard Loading"",""given"":""Historical data sync is complete"",""when"":""I load the dashboard page"",""then"":""The Sales Trend chart and KPI cards render within 2.5 seconds (LCP requirement).""},{""scenario"":""Date Filtering"",""given"":""I am viewing the dashboard"",""when"":""I change the date range filter"",""then"":""The API is called with new parameters and the charts update to reflect the selected period.""},{""scenario"":""Performance Aggregation"",""given"":""I request data for a large date range"",""when"":""The backend processes the request"",""then"":""The ClickHouse OLAP query returns results in under 200ms (p95 latency).""}]","[""WI-REP-001: Develop Dashboard KPI API"",""WI-UI-001: Build Main Dashboard UI"",""WI-DATA-001: Design & Apply ClickHouse Schema""]","[""ClickHouse SQL queries optimized with sorting keys"",""Recharts components implemented with responsive design"",""API endpoint enforces merchant_id scoping"",""Skeleton loaders implemented for wait states""]"
"US-035","AI Assistant (RAG)","Natural Language Data Querying via AI Chat","Store Owner","As a Store Owner, I want to ask questions about my data in plain English so that I can get insights without navigating complex reports or knowing SQL.","High-value differentiator that democratizes data access for non-technical users, increasing engagement.","Should Have","13","[""US-022""]","[{""scenario"":""Successful RAG Query"",""given"":""I ask 'What were my top 5 products last month?'"",""when"":""I submit the query in the chat interface"",""then"":""The system retrieves relevant context, generates a safe SQL query, executes it, and displays the result.""},{""scenario"":""Data Privacy Enforcement"",""given"":""I submit a query"",""when"":""The prompt is constructed for the LLM"",""then"":""No PII (Personally Identifiable Information) is sent to OpenAI, and the generated SQL is restricted to my Tenant ID.""},{""scenario"":""Dynamic Response Rendering"",""given"":""The AI returns time-series data"",""when"":""The response is received by the UI"",""then"":""The chat component renders a chart visualization instead of just text.""}]","[""WI-AI-001: Setup pgvector & Embedding Generation"",""WI-AI-002: Implement NLQ API (RAG Flow)"",""WI-AI-003: Develop AI Chat Component""]","[""pgvector extension enabled and populated"",""Prompt engineering guards against injection"",""Chat UI handles loading and error states"",""Strict PII scrubbing implemented in API layer""]"
"US-041","Abandoned Cart Recovery","Configure and Schedule Cart Recovery Sequences","Marketer","As a Marketer, I want to create email templates and configure automatic sending sequences for abandoned carts so that I can recover lost revenue.","Directly impacts merchant revenue by automating the recovery of potential sales that would otherwise be lost.","High","8","[""US-012""]","[{""scenario"":""Template Creation"",""given"":""I am in the campaign editor"",""when"":""I use the rich text editor to create an email"",""then"":""I can insert dynamic variables like {{customer_name}} and save the template.""},{""scenario"":""Sequence Logic"",""given"":""I have defined a sequence with a 1-hour delay"",""when"":""A cart is flagged as abandoned"",""then"":""The system schedules an email job via QStash to fire exactly 1 hour later.""},{""scenario"":""Detection Job"",""given"":""A cart has not been updated for 60 minutes"",""when"":""The scheduled cron job runs"",""then"":""The cart is flagged as 'Abandoned' in the database and triggers the recovery workflow.""}]","[""WI-CART-001: Abandoned Cart Detection Job"",""WI-CART-002: Email Scheduler & Sender Service"",""WI-CART-003: Email Template Editor"",""WI-CART-004: Recovery Sequence Builder""]","[""Cron job configured and tested"",""QStash scheduling logic verified"",""Postmark integration sends emails correctly"",""Rich text editor sanitizes HTML output""]"
"US-016","Authentication & User Management","Team Member Invitation and RBAC","Store Owner","As a Store Owner, I want to invite team members with specific roles (Admin, Analyst) so that I can delegate tasks securely without sharing my credentials.","Enables organizational scalability and improves security posture by enforcing least-privilege access.","Should Have","5","[""US-001""]","[{""scenario"":""Send Invitation"",""given"":""I enter an email and select the 'Analyst' role"",""when"":""I click invite"",""then"":""An email is sent via Postmark with a secure, time-limited link (7 days).""},{""scenario"":""Role Enforcement"",""given"":""An 'Analyst' user is logged in"",""when"":""They attempt to access 'Owner' only settings"",""then"":""The system middleware denies access and returns a 403 Forbidden error.""},{""scenario"":""Invitation Acceptance"",""given"":""I click the invitation link"",""when"":""I register or log in"",""then"":""I am added to the team with the correct role and can switch to that merchant context.""}]","[""WI-RBAC-001: Develop RBAC Middleware & Utilities"",""WI-TEAM-001: Team Invitation & Management System""]","[""Middleware correctly checks roles and MerchantID"",""Invitation tokens are secure and expire"",""E2E test covers invite -> accept flow""]"