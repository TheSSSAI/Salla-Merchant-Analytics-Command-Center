"story_id","epic","title","user_role","description","business_value","priority","story_points","dependencies","acceptance_criteria","technical_tasks","definition_of_done"
"US-001","Core Infrastructure & Authentication","Register new merchant account with secure authentication","New Merchant","As a New Merchant, I want to create a new account using my email address and a secure password, while agreeing to the legal terms, so that I can gain access to the platform and begin the process of connecting my store.","Enables user acquisition by providing the primary entry point for new merchants to join the platform. This is the first step in the customer conversion funnel.","Must Have","5","[]","[{""scenario"":""Successful registration with valid and unique credentials"",""given"":""I am a new user on the registration page and the email is not in the system"",""when"":""I enter a valid email, a complex password, check the terms box, and click 'Register'"",""then"":""A new user account is created, password is hashed (Argon2), JWT token is issued, and I am redirected to the Salla connection page""},{""scenario"":""Registration attempt with existing email"",""given"":""A user account with the email already exists"",""when"":""I attempt to register using the existing email"",""then"":""The system prevents registration and displays an inline error 'An account with this email already exists'""}]","[""WI-INFRA-001: Initialize Next.js Repository"",""WI-DB-001: Design & Implement Prisma Schema (Users table)"",""WI-AUTH-001: Implement JWT Authentication Service""]","[""User record created in PostgreSQL"",""Password stored as Argon2/Bcrypt hash"",""JWT Access/Refresh tokens generated correctly"",""Unit tests for AuthService pass with >80% coverage""]"
"US-009","Salla Integration & Data Ingestion","Connect Salla store via OAuth 2.0","Store Owner","As a new Store Owner, I want to be guided through a secure process to connect my Salla store to the application, so that the system can access my store's data and I can begin using the analytics features.","Enables the core functionality of the application by establishing a secure data connection to the merchant's Salla store.","Must Have","8","[""US-001""]","[{""scenario"":""Successful Salla store connection"",""given"":""I am a logged-in user on the initial setup screen"",""when"":""I click 'Connect Salla Store', authorize on Salla, and am redirected back"",""then"":""The system exchanges the auth code for tokens, encrypts/stores them, and redirects me to the Data Sync selection""},{""scenario"":""User denies authorization"",""given"":""I have been redirected to Salla OAuth page"",""when"":""I click 'Deny' or 'Cancel'"",""then"":""I am redirected back with an error message and no tokens are stored""}]","[""WI-INT-001: Implement Salla OAuth 2.0 Flow"",""WI-DB-001: Schema update for SallaTokens table""]","[""OAuth callback handles code exchange successfully"",""Access/Refresh tokens stored encrypted (AES-256)"",""State parameter validation prevents CSRF"",""E2E test mocks Salla response""]"
"US-012","Salla Integration & Data Ingestion","View progress of initial historical data synchronization","Store Owner","As a new merchant, I want to see a clear and continuously updated progress indicator for the initial historical data synchronization, so that I understand the status of the import and when the platform will be ready.","Improves onboarding experience by providing transparency during long-running background processes, reducing user anxiety and support tickets.","Should Have","5","[""US-009""]","[{""scenario"":""Display of progress indicator when sync is active"",""given"":""The background sync job has started"",""when"":""I navigate to the dashboard"",""then"":""A persistent progress bar displays percentage complete and status message""},{""scenario"":""Sync completion"",""given"":""The sync job finishes successfully"",""when"":""The backend updates the status to COMPLETED"",""then"":""The progress indicator disappears and a success notification is shown""}]","[""WI-DATA-001: Implement Historical Data Import Job"",""WI-UI-002: Data Sync Progress UI"",""WI-INT-002: Develop Webhook Handler Service (for real-time updates)""]","[""Background job reports progress to DB/Redis"",""Frontend polls status endpoint efficiently"",""UI handles 'In Progress', 'Completed', and 'Failed' states"",""QStash integration verified""]"
"US-016","Core Infrastructure & Authentication","Invite team members with role-based access","Store Owner","As a Store Owner, I want to invite team members by email and assign them a specific role (Admin, Analyst), so that I can securely delegate tasks without sharing my credentials.","Enables team collaboration and secure delegation while enforcing the principle of least privilege.","Should Have","5","[""US-001""]","[{""scenario"":""Owner invites a new user"",""given"":""I am logged in as Owner on the Team Management page"",""when"":""I enter an email, select 'Analyst', and click Send"",""then"":""An invitation email is sent, and the user appears as 'Pending' in the list""},{""scenario"":""Non-Owner attempts invitation"",""given"":""I am logged in as an 'Analyst'"",""when"":""I attempt to access the invitation API"",""then"":""The request is rejected with 403 Forbidden""}]","[""WI-SEC-001: Implement RBAC Middleware"",""WI-UI-001: Develop User & Team Management UI""]","[""Invitation token generated and emailed"",""RBAC middleware blocks unauthorized roles"",""User-Merchant relationship stored in DB"",""Audit log entry created""]"
"US-022","Advanced Analytics & Reporting","View main dashboard with KPIs","Store Owner","As a merchant user, I want to view a central dashboard that displays my store's key performance indicators (Sales, Orders, AOV) so that I can quickly assess business health.","Provides immediate, at-a-glance insight into business performance, enabling faster decision-making.","Must Have","8","[""US-012""]","[{""scenario"":""Default dashboard view"",""given"":""Data sync is complete"",""when"":""I navigate to the main dashboard"",""then"":""I see KPI cards for Total Sales, Orders, and AOV filtered by 'Last 30 Days'""},{""scenario"":""Changing date filter"",""given"":""I am viewing the dashboard"",""when"":""I select 'Last 7 Days'"",""then"":""All KPI cards update to reflect the new time period within 200ms""}]","[""WI-DATA-002: Design ClickHouse Schema (OLAP)"",""WI-DATA-003: Implement CDC Pipeline"",""WI-API-001: Develop Analytics API Endpoints"",""WI-UI-003: Implement Interactive Charts""]","[""Data served from ClickHouse OLAP"",""API p95 latency < 200ms"",""Charts render using Recharts"",""Data is scoped strictly to tenant ID""]"
"US-032","Advanced Analytics & Reporting","View 30-day sales forecast","Data Analyst","As a merchant, I want to view a 30-day sales forecast with confidence intervals, so that I can make informed decisions about inventory and marketing planning.","Enables proactive business management by providing data-driven projections of future sales.","Could Have","8","[""US-022""]","[{""scenario"":""Display forecast chart"",""given"":""The store has sufficient historical data"",""when"":""I view the forecasting module"",""then"":""A line chart displays projected sales for the next 30 days with a shaded confidence interval""},{""scenario"":""Insufficient data"",""given"":""The store has < 3 months of data"",""when"":""I view the forecasting module"",""then"":""A message appears stating more data is required to generate a forecast""}]","[""WI-FEAT-001: Implement Sales Forecasting (ETS)""]","[""ETS algorithm implemented correctly"",""Forecast calculation optimized (cached/scheduled)"",""Chart visualization clearly shows trends vs actuals""]"
"US-035","AI Assistant & RAG","Ask questions about business data in natural language","Store Owner","As a merchant, I want to ask questions about my business data in plain language (e.g., 'What were my sales last week?') so that I can get quick answers without navigating complex reports.","Reduces the time and expertise needed to query data, accelerating decision-making for non-technical users.","Should Have","13","[""US-022""]","[{""scenario"":""Query for simple metric"",""given"":""I am on the AI Assistant page"",""when"":""I type 'What were my total sales last week?'"",""then"":""The system displays the correct aggregated sales figure formatted as currency""},{""scenario"":""Out of scope query"",""given"":""I ask a question unrelated to store data"",""when"":""I submit the query"",""then"":""The assistant replies that it can only answer questions about sales/products""}]","[""WI-AI-001: Setup pgvector & Embedding Service"",""WI-AI-002: Develop AI Query Service (NL to SQL)""]","[""RAG pipeline retrieves correct schema context"",""OpenAI generates valid ClickHouse SQL"",""SQL execution is read-only and tenant-scoped"",""Prompt injection protection verified""]"
"US-041","Abandoned Cart Recovery Automation","Create automated cart recovery email sequence","Marketer","As a Marketer, I want to create multi-step email sequences with specific time delays, so that I can automatically follow up with customers who abandoned their carts.","Increases revenue by automating the recovery of lost sales with minimal manual effort.","Must Have","8","[""US-009""]","[{""scenario"":""Create multi-step sequence"",""given"":""I have created email templates"",""when"":""I define a sequence with Step 1 (1hr delay) and Step 2 (24hr delay)"",""then"":""The sequence is saved and jobs are scheduled for abandoned carts""},{""scenario"":""Purchase stops sequence"",""given"":""A customer is in a recovery sequence"",""when"":""The customer completes the purchase"",""then"":""Remaining scheduled emails for that cart are cancelled""}]","[""WI-JOB-001: Implement Abandoned Cart Scheduler"",""WI-EMAIL-001: Implement Rich Text Email Template Editor""]","[""Scheduler correctly identifies abandoned carts"",""QStash jobs triggered with correct delays"",""Purchase webhook cancels pending jobs"",""Emails dispatched via Postmark""]"
"US-043","Abandoned Cart Recovery Automation","Design email templates with rich text editor","Marketer","As a Marketer, I want to create email templates using a rich text editor with dynamic variables (e.g., {{customer_name}}), so that I can send personalized and professional recovery emails.","Empowers users to create on-brand marketing communications directly within the platform.","Should Have","5","[]","[{""scenario"":""Create template with variables"",""given"":""I am in the template editor"",""when"":""I insert '{{customer_name}}' and save"",""then"":""The template is saved and the variable is correctly replaced during sending""},{""scenario"":""XSS Protection"",""given"":""I try to insert malicious script tags in the editor"",""when"":""I save the template"",""then"":""The content is sanitized and script tags are removed""}]","[""WI-EMAIL-001: Implement Rich Text Email Template Editor""]","[""Rich text editor (TipTap/Quill) integrated"",""HTML content sanitized on backend"",""Dynamic variable substitution logic works""]"